// prisma/schema.prisma

// Configuração do banco de dados
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Gerador do Prisma Client
generator client {
  provider = "prisma-client-js"
}

// Tabela de Clientes
model Cliente {
  id     Int     @id @default(autoincrement())
  nome   String
  email  String  @unique
  pedidos Pedido[] // Um cliente pode ter vários pedidos
}

// Tabela de Produtos
model Produto {
  id            Int     @id @default(autoincrement())
  nome          String
  preco         Float
  pedidos       ProdutosEmPedidos[] // Um produto pode estar em vários pedidos
}

// Tabela de Pedidos
model Pedido {
  id         Int      @id @default(autoincrement())
  data       DateTime @default(now())
  status     StatusPedido @default(PENDENTE)
  
  cliente    Cliente  @relation(fields: [clienteId], references: [id])
  clienteId  Int

  produtos   ProdutosEmPedidos[] // Um pedido pode ter vários produtos
}

// Tabela "Pivô" para a relação Muitos-para-Muitos entre Pedido e Produto
model ProdutosEmPedidos {
  pedido    Pedido  @relation(fields: [pedidoId], references: [id])
  pedidoId  Int
  produto   Produto @relation(fields: [produtoId], references: [id])
  produtoId Int

  @@id([pedidoId, produtoId]) // Chave primária composta
}

// Enum para o status do pedido
enum StatusPedido {
  PENDENTE
  PAGO
}